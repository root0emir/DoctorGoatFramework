name: "Custom Security Profile Example"
description: "Example custom security profile for demonstration purposes"
version: "1.0"
author: "root0emir"
created_at: "2025-04-24"

checks:
  - id: "CUSTOM-001"
    title: "Ensure SSH root login is disabled"
    description: "SSH root login should be disabled to prevent direct root access"
    severity: "high"
    check_type: "file_content"
    file: "/etc/ssh/sshd_config"
    pattern: "^PermitRootLogin\\s+no"
    remediation: "Edit /etc/ssh/sshd_config and set 'PermitRootLogin no'"
    
  - id: "CUSTOM-002"
    title: "Ensure firewall is enabled"
    description: "A firewall should be enabled to control network traffic"
    severity: "high"
    check_type: "command"
    command: "systemctl status firewalld"
    expected_result: 0
    remediation: "systemctl enable --now firewalld"
    
  - id: "CUSTOM-003"
    title: "Ensure password expiration is 90 days or less"
    description: "Password expiration should be set to 90 days or less"
    severity: "medium"
    check_type: "file_content"
    file: "/etc/login.defs"
    pattern: "^PASS_MAX_DAYS\\s+([0-9]+)"
    expected_match: "value <= 90"
    remediation: "Edit /etc/login.defs and set 'PASS_MAX_DAYS 90'"
    
  - id: "CUSTOM-004"
    title: "Ensure AIDE is installed"
    description: "AIDE (Advanced Intrusion Detection Environment) should be installed for file integrity checking"
    severity: "medium"
    check_type: "package"
    package: "aide"
    expected_state: "installed"
    remediation: "apt-get install aide && aide --init && mv /var/lib/aide/aide.db.new /var/lib/aide/aide.db"
    
  - id: "CUSTOM-005"
    title: "Ensure core dumps are restricted"
    description: "Core dumps should be restricted to prevent sensitive information disclosure"
    severity: "medium"
    check_type: "file_content"
    file: "/etc/security/limits.conf"
    pattern: "\\*\\s+hard\\s+core\\s+0"
    remediation: "Add '* hard core 0' to /etc/security/limits.conf"
